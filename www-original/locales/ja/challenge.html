
<header>
  <div ng-if="offline || !selectedWorld || !selectedWorld.display_menu" class="main-navigation page-width"><a href="/" class="logo"><img ng-src="{{ _config.UI_ROOT + &quot;assets/layout/draw-logo@2x.png&quot; }}" alt="main logo"/></a>
    <ul class="nav nav-left">
      <li><a href="/challenges" ng-class="{ active: basePath === &quot;challenge&quot; || basePath === &quot;challenges&quot; }"><i class="icon-menu"></i>チャレンジ一覧</a></li>
      <li><a href="/playground" ng-class="{ active: basePath === &quot;playground&quot; }"><i class="icon-game"></i>遊び場</a></li>
    </ul>
    <ul ng-cloak="ng-cloak" class="nav nav-right">
      <li class="discover"><a ng-if="!offline" id="discover-kano" href="http://world.kano.me/start" target="_blank"><i class="icon-cpu"></i>Kanoを探検する</a></li>
      <li ng-if="!offline &amp;&amp; !loggedIn"><a href="" ng-click="auth.openModal(&quot;login&quot;)"><i class="icon-login"></i>ログイン</a></li>
      <li ng-if="!offline &amp;&amp; !loggedIn"><a href="" ng-click="auth.openModal(&quot;signup&quot;)" class="signup">サインアップ</a></li>
      <li ng-if="!offline &amp;&amp; loggedIn"><a ng-href="http://world.kano.me/users/{{ user.username }}" target="_blank" class="user-display">
          <div class="avatar"><img ng-src="{{ user.avatar.urls.circle || cfg.DEFAULT_AVATAR }}"/></div>{{ user.username }}</a></li>
      <li ng-if="!offline &amp;&amp; loggedIn"><a href="" ng-click="logout()"><i class="icon-logout"></i>ログアウト</a></li>
      <li>
        <button ng-click="shutdown()" ng-if="offline" class="close"><i class="icon-cross"></i></button>
      </li>
    </ul>
  </div>
</header>
<!-- Uncomment to enable banner-->
<!-- include banner-->
<div class="page-challenge">
  <div class="page-width">
    <div ng-class="(animationClass || &quot;&quot;) + (completed ? &quot; success&quot; : &quot;&quot;) + (fatherDay ? &quot; father-day&quot; : &quot;&quot;)" class="workspace-header">
      <div ng-if="!started" class="inner center">
        <h3>{{ id }}チャレンジ： {{ challenges[ id - 1 ].title }}</h3>
        <h4>{{ challenges[ id - 1 ].description }}</h4>
        <button ng-click="start()" class="button-success">スタート</button>
      </div>
      <div ng-if="started &amp;&amp; !completed" class="inner">
        <div class="hint-container">
          <div class="hint-content">
            <div class="progress-circle-image">
              <progress-circle value="step" max="content.steps.length"></progress-circle>
            </div>
            <div class="inner-text">
              <h3>{{ challenges[ id - 1 ].title }}</h3>
              <h4 ng-bind-html="hint | markdown" ng-if="hint" class="hint"></h4>
            </div>
          </div>
          <div class="button-container"><a ng-click="toggleSolution()" ng-class="{ active: showSolution, &quot;animate-pulse-highlight&quot;: highlightHelp }" class="button button-hint large right"><i class="icon-hint"></i>ヒント</a></div>
        </div>
      </div>
      <div ng-if="completed &amp;&amp; !fatherDay" class="inner center">
        <div class="completion">
          <div class="text">
            <h4 ng-if="offline">*challenge.success_offline*</h4>
            <h4 ng-if="!offline">*challenge.success_online*</h4><a ng-click="goToNext()" class="button button-success">{{ next ? '次へ' : '終わり' }} &rsaquo;</a>
          </div>
          <div ng-if="content.gallery" class="gallery">
            <h4>これもチャレンジしてみるかい？</h4>
            <div class="remixes">
              <div ng-repeat="remix in content.gallery.remixes" ng-style="{&quot;background-image&quot;: &quot;url(&quot; + content.gallery.cover_path + remix + &quot;)&quot;}" class="image"></div>
            </div>
          </div>
        </div>
      </div>
      <div ng-if="completed &amp;&amp; fatherDay" class="inner center">
        <div ng-if="!user"><img src="/assets/layout/father-day-closed.png"/>
          <h4>父の日のカードにしよう！</h4>
          <p>さあ、Kanoワールドに登路し、作品を共有し、お父さんへカードを送ろう！</p><a ng-click="login()" href="#" class="button large button-success">Log In / Sign Up</a>
        </div>
        <div ng-if="user"><img src="/assets/layout/father-day-open.png"/>
          <h4>父の日のカードを共有しよう！</h4>
          <p>よっし、Kanoワールドでカードを共有し、お父さんへ送られるよ！</p><a ng-click="shareFatherDay()" href="#" class="button large button-success">Share it!</a>
        </div>
      </div>
    </div>
    <div ng-if="started" class="row">
      <div class="col-6 editor-wrap">
        <editor workspace="workspace" ng-model="challenge.code" ng-class="{ completed: completed }" ng-change="validate()" editable="started" start-at-line="content.startAt" tabbed="true" controls="true"></editor>
      </div>
      <div class="col-6 tutorial-wrap">
        <display reset-fn="restart" source="challenge.code" workspace="workspace" mode="&quot;challenge&quot;" sharing="completed" ng-class="{ disabled: !started }" ng-show="!showSolution"></display>
        <editor ng-if="showSolution &amp;&amp; solution" ng-model="solution" title="&quot;正解は…&quot;" class="solution">{{ solution }}</editor>
      </div>
    </div>
    <div ng-if="gameCompleteOpen" class="modal-overlay">
      <div ng-if="selectedWorld.id !== &quot;hourofcode&quot;" class="modal-inner split-modal challenge-complete center">
        <h3>チャレンジ完了！</h3>
        <h4 ng-if="!unlockedWorld">さあ、新しいものを作ろう！</h4>
        <h4 ng-if="unlockedWorld">新しいワールドに入れるよ！ 早速遊ぼうー<a href="/challenges/{{ unlockedWorld.id }}" class="button unlocked">{{ unlockedWorld.name }}</a></h4>
        <div class="logo-title"></div>
        <div class="center bottom-section"><a ng-href="/challenges" class="button secondary large"><i class="icon-menu"></i> メニュー</a><a ng-href="/playground" class="button large"><i class="icon-game"></i> 遊び場</a></div>
      </div>
      <div ng-if="selectedWorld.id === &quot;hourofcode&quot;" class="modal-inner split-modal challenge-complete center">
        <h3>チャレンジ完了！</h3>
        <h4>やったぜ！ 戻って、コードでもっと遊ぼう！</h4>
        <div class="hour-of-code-logo"></div>
        <div class="center bottom-section"><a href="http://code.org/learn" class="button large"><i class="icon-game"></i> ハウアー・オブ・コード</a></div>
      </div>
    </div>
  </div>
</div>
<div ng-if="nextModal" class="modal-overlay flexcenter-top">
  <div class="modal-inner modal-next-challenge center">
    <div ng-style="{ &quot;background-image&quot;: &quot;url(&quot; + _config.UI_ROOT + &quot;assets/challenges/images/&quot; + next.cover +&quot;)&quot; }" class="cover"></div>
    <button ng-click="closeNextModal()" class="close"><i class="icon-cross"></i></button>
    <div class="detail">
      <div class="title">次は：<span>{{ next.title }}</span><a ng-href="/challenges/{{selectedWorld.id}}" ng-if="next.locked" class="button button-success">{{ selectedWorld ? selectedWorld.name + 'へ戻る' : 'メニュー' }}</a><a ng-href="/challenge/{{selectedWorld.id}}/{{next.id}}" ng-if="!next.locked" class="button button-success">スタート</a></div>
      <p class="description">{{ next.description }}</p>
      <p ng-if="next.locked" class="description small">明日戻ってきて、このチャレンジを続けよう。</p>
    </div>
    <div ng-if="creation &amp;&amp; !mailTab" class="social-sharing">
      <div class="image"><img ng-src="{{ creation.cover_url }}"/></div>
      <div class="detail"><span class="title">{{ creation.title }}</span>
        <div class="description">{{ creation.description }}</div>
      </div>
      <div class="buttons"><a ng-click="openMailTab()" class="button button-mail"><i class="icon-mail"></i></a><a ng-click="facebookShare(creation)" class="button button-facebook"><img ng-src="{{ _config.UI_ROOT + &quot;assets/button-icons/facebook-white.png&quot; }}" title="Facebookで共有する"/></a><a target="_new" ng-href="{{ buildURL(creation) }}" class="button button-twitter"><img ng-src="{{ _config.UI_ROOT + &quot;assets/button-icons/twitter-white.png&quot; }}" title="Twitterで共有する"/></a></div>
    </div>
    <div ng-if="mailTab" class="mail-tab center"><span>eメールで共有</span>
      <form ng-submit="sendMail(creation)" name="mailForm">
        <div ng-if="error" class="box box-danger">{{ error }}</div>
        <div class="email">
          <input ng-model="creation.email" placeholder="Email address" type="email" required="required"/>
        </div>
        <button type="submit" ng-disabled="mailForm.$invalid" ng-class="{ &quot;disabled&quot; : mailForm.$invalid }" ng-if="!loading" class="button-success">送信</button>
        <div ng-if="loading" class="spinner"></div>
      </form>
    </div>
  </div>
</div>
<div ng-if="shareModal &amp;&amp; creation" class="modal-overlay">
  <div class="modal-inner modal-share-creation center">
    <div ng-style="{ &quot;background-image&quot;: &quot;url(&quot; + creation.cover_url + &quot;)&quot; }" class="cover"></div>
    <div ng-if="!mailTab" class="detail">
      <div class="title"><span>{{ creation.title }}</span></div>
      <p class="description">{{ creation.description }}</p>
    </div>
    <div ng-if="!mailTab" class="buttons">友達と共有する：<a ng-click="openMailTab()" class="button button-mail"><i class="icon-mail"></i></a><a ng-click="facebookShare(creation)" class="button button-facebook"><img ng-src="{{ _config.UI_ROOT + &quot;assets/button-icons/facebook-white.png&quot; }}" title="Facebookで共有する"/></a><a ng-click="twitterShare(creation)" class="button button-twitter"><img ng-src="{{ _config.UI_ROOT + &quot;assets/button-icons/twitter-white.png&quot; }}" title="Twitterで共有する"/></a></div>
    <div ng-if="selectedWorld.share_strategy === &quot;optional&quot;" class="skip-sharing">
      <button ng-click="skipSocialSharing()" class="button-success">共有しない</button>
    </div>
    <div ng-if="mailTab" class="mail-tab center"><span>eメールで共有</span>
      <form ng-submit="sendMail(creation)" name="mailForm">
        <div ng-if="error" class="box box-danger">{{ error }}</div>
        <div class="email">
          <input ng-model="creation.email" placeholder="メールアドレス" type="email" required="required"/>
        </div>
        <button type="submit" ng-disabled="mailForm.$invalid" ng-class="{ &quot;disabled&quot; : mailForm.$invalid }" ng-if="!loading" class="button-success">送信</button>
        <div ng-if="loading" class="spinner"></div>
      </form>
    </div>
  </div>
</div>
<div ng-if="mailPreview" class="modal-overlay">
  <div class="modal-inner modal-mail-preview center">
    <button ng-click="closePreview()" class="close"><i class="icon-cross"></i></button>
    <div class="preview">
      <div class="header">eメールで共有</div>
      <h4>"{{ selectedSummerChallengeObj.shareTitle }}"</h4>
      <div class="content">
        <div class="left-content">
          <input type="email" ng-model="selectedSummerChallengeObj.email" placeholder="メールアドレスを入力"/>
          <textarea ng-model="selectedSummerChallengeObj.message" placeholder="さっき、これをコードで作ったよ！あなたもやってみませんか？簡単で皆で遊べるよ。"></textarea>
          <input type="text" ng-model="selectedSummerChallengeObj.name" placeholder="お名前…"/>
        </div>
        <div class="right-content">
          <div class="pic"><img ng-src="{{selectedSummerChallengeObj.img}}" ng-if="!selectedSummerChallengeObj.cover_url"/><img ng-src="{{selectedSummerChallengeObj.cover_url}}" ng-if="selectedSummerChallengeObj.cover_url"/></div><a ng-click="sendMail(selectedSummerChallengeObj)" class="button button-success">送信</a>
        </div>
      </div>
    </div>
  </div>
</div>
<div ng-show="auth.showModal" ng-cloak="ng-cloak" ng-click="auth.overlayClicked($event)" class="modal-overlay">
  <kwc-auth></kwc-auth>
</div>